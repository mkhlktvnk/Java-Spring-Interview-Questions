# Spring Web

## Для чего нужен модуль Spring Web? Какие возможности он добавляет в Java-приложение?

Spring Web - это модуль фреймворка Spring, который добавляет возможности для разработки веб-приложений на Java.
Он предоставляет следующие функциональности:

1. Обработка HTTP-запросов и отправка HTTP-ответов: Spring Web позволяет создавать контроллеры, которые принимают
   HTTP-запросы и возвращают соответствующие HTTP-ответы.

2. Конвертация Java-объектов в JSON и обратно: Spring Web автоматически выполняет сериализацию и десериализацию
   Java-объектов в формат JSON, позволяя легко передавать данные между клиентом и сервером.

3. Маршрутизация запросов: Spring Web предоставляет механизм для определения путей URL, по которым будет обрабатываться
   каждый HTTP-запрос.

4. Валидация и обработка ошибок: Spring Web предоставляет инструменты для валидации входных данных и обработки ошибок в
   единообразном способе.

5. Обработка файлов: Spring Web позволяет загружать и отправлять файлы с помощью механизма мультипартных запросов.

## Какую архитектуру реализует Spring Web?

Spring Web реализует архитектуру MVC (Model-View-Controller). Архитектура MVC включает следующие компоненты:

1. Модель (Model): Представляет бизнес-логику и данные, с которыми работает приложение. Модель может быть представлена в
   виде Java-классов, отражающих сущности приложения.

2. Представление (View): Отвечает за отображение данных модели пользователю. В контексте RESTful API представление
   обычно представляется в формате JSON или XML.

3. Контроллер (Controller): Обрабатывает входящие HTTP-запросы, взаимодействует с моделью и формирует ответы, которые
   отправляются обратно клиенту. В Spring Web контроллеры являются компонентами, аннотированными специальными
   аннотациями, такими как `@RestController` или `@Controller`.

В архитектуре MVC контроллер обрабатывает запросы, получает данные из модели (например, через сервисный слой) и передает
их в представление для отображения. Результаты выполнения запроса отправляются обратно клиенту в виде HTTP-ответов либо
страниц.

## Как выглядит жизненный цикл HTTP-запроса в Spring Web?

![img.png](../../images/spring-web/img.png)

1. Входящий HTTP-запрос: Сервер принимает входящий HTTP-запрос от клиента.

2. `DispatcherServlet`: Запрос принимается `DispatcherServlet`. Он выполняет следующие действия:

    - Определение обработчика (Handler): `DispatcherServlet` использует `HandlerMapping` для определения, какой
      обработчик (контроллер) должен быть вызван для данного запроса.
    - Выбор `HandlerAdapter`: `DispatcherServlet` выбирает подходящий `HandlerAdapter`, который будет использоваться для
      вызова метода обработчика (контроллера).

3. `HandlerMapping`: `HandlerMapping` отображает URL запроса на соответствующий обработчик (контроллер). Он может быть
   настроен, например, с использованием аннотации `@RequestMapping` на уровне класса или метода контроллера.

4. `HandlerAdapter`: `HandlerAdapter` является мостом между `DispatcherServlet` и методом обработчика (контроллера). Он
   обеспечивает вызов метода обработчика с правильными аргументами и возвращает результат выполнения.

5. Выполнение обработчика (контроллера): `HandlerAdapter` вызывает соответствующий метод обработчика (контроллера),
   передавая необходимые аргументы. В методе контроллера выполняется бизнес-логика, взаимодействие с сервисами и
   формирование данных для ответа.

6. Формирование ответа: После выполнения метода обработчика, `DispatcherServlet` получает данные, сгенерированные
   методом, и формирует HTTP-ответ. Ответ может содержать данные, HTTP-статус, заголовки и другую информацию.

7. Отправка ответа клиенту: `DispatcherServlet` отправляет сформированный ответ обратно клиенту.

## Что такое DispatcherServlet? Для чего он нужен? Какие функции он выполняет?

`DispatcherServlet` - это центральный сервлет в Spring MVC, который является точкой входа для обработки HTTP-запросов в
приложении.
`DispatcherServlet` является центральным компонентом в Spring Web и выполняет следующие функции:

1. Централизация обработки запросов: `DispatcherServlet` является точкой входа для обработки HTTP-запросов в приложении.

2. Распределение запросов: Он определяет, какой обработчик (контроллер) должен быть вызван для каждого запроса,
   используя `HandlerMapping`.

3. Вызов метода обработчика: `DispatcherServlet` выбирает соответствующий `HandlerAdapter`, который вызывает метод
   обработчика (контроллера) с правильными аргументами.

4. Управление жизненным циклом запроса: `DispatcherServlet` управляет жизненным циклом HTTP-запроса, вызывая необходимые
   компоненты и обрабатывая все этапы запроса.

5. Обработка исключений: `DispatcherServlet` обрабатывает исключения, возникающие во время обработки запроса, и
   возвращает соответствующий HTTP-ответ с кодом ошибки или другой информацией об ошибке.

6. Формирование HTTP-ответа: `DispatcherServlet` получает результат выполнения метода обработчика (контроллера) и
   формирует HTTP-ответ, который включает данные, статус, заголовки и другую информацию.

## Что входит в основные компоненты для работы с HTTP Spring Web?

1. Фронт-контроллер (Front Controller): Центральный компонент, который получает все входящие HTTP-запросы и диспетчирует
   их на соответствующие обработчики. (Аннотация `@Controller`, `@RestController`)

2. Обработчики (Handlers): Компоненты, которые обрабатывают конкретные HTTP-запросы. В Spring Web обработчики
   представляют собой методы, аннотированные специальными аннотациями, такими как `@RequestMapping` или `@GetMapping`.

3. Конвертеры (Converters): Компоненты, которые отвечают за преобразование данных между форматом запроса/ответа (
   например, JSON) и Java-объектами. В Spring Web используется `HttpMessageConverter` для автоматической сериализации и
   десериализации данных.

4. Маршрутизация (Routing): Механизм, который определяет, какой обработчик будет вызываться для каждого входящего
   запроса. В Spring Web это достигается с помощью аннотации `@RequestMapping` или специальных аннотаций, таких
   как `@GetMapping` или `@PostMapping`.

5. Обработка ошибок (Error Handling): Механизм, который позволяет обрабатывать и возвращать стандартизированные ошибки в
   случае возникновения исключений. В Spring Web можно использовать аннотацию `@ExceptionHandler` для обработки
   конкретных исключений и возврата соответствующих HTTP-ответов.

6. Фильтры (Filters): Компоненты, которые позволяют выполнять дополнительную обработку запросов и ответов до того, как
   они достигнут обработчиков. В Spring Web можно использовать классы, реализующие интерфейс `javax.servlet.Filter`, для
   определения фильтров.

## Опишите основные аннотации Spring Web.

1. `@Controller`: Обозначает класс как контроллер, который обрабатывает HTTP-запросы и возвращает ответы.

2. `@RestController`: Обозначает класс как контроллер, который обрабатывает HTTP-запросы и возвращает ответы, в тело
   которых входит именно возвращаемое значение метода обработчика.

3. `@RequestMapping`: Устанавливает сопоставление между URL-адресами и методами контроллера, определяя, какой метод
   должен быть вызван при обращении к определенному URL.

4. `@PathVariable`: Используется для извлечения переменных из URL-шаблона и передачи их в метод контроллера в качестве
   аргументов.

5. `@RequestBody`: Используется для привязки данных запроса к объекту в методе контроллера, когда данные передаются в
   теле запроса.

6. `@RequestParam`: Используется для получения значений параметров запроса из URL или тела запроса.

7. `@GetMapping`, `@PostMapping`, `@PutMapping`, `@DeleteMapping`: Обозначают методы контроллера как обработчики GET,
   POST, PUT и DELETE запросов соответственно.

8. `@ResponseBody`: Обозначает, что метод контроллера должен возвращать тело HTTP-ответа напрямую, без привязки к
   представлению.

9. `@ResponseStatus`: Устанавливает статус HTTP-ответа, возвращаемого методом контроллера.

10. `@ExceptionHandler`: Обрабатывает исключения, возникающие в методах контроллера, и возвращает пользовательские
    ответы ошибок.

## С помощью чего в Spring Web данные конвертируются в JSON/XML при отправке ответа?

В Spring Web данные конвертируются в JSON/XML при отправке ответа с помощью следующих компонентов:

1. **Jackson/Gson**: Spring Web часто использует библиотеки Jackson или Gson для преобразования объектов Java в JSON и
   обратно. Jackson является стандартной библиотекой для работы с JSON в Spring, а Gson также широко применяется и
   поддерживается.

2. **HttpMessageConverters**: Spring Web использует конвертеры сообщений HTTP для преобразования объектов Java в формат
   JSON/XML и наоборот. Конвертеры сообщений HTTP обрабатывают сериализацию и десериализацию объектов между
   Java-объектами и форматами JSON/XML. Spring предоставляет несколько встроенных конвертеров сообщений, таких
   как `MappingJackson2HttpMessageConverter` для JSON и `MappingJackson2XmlHttpMessageConverter` для XML. Конвертеры
   сообщений могут быть настроены в конфигурации приложения для поддержки нужных форматов данных.







